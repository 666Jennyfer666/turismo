(this.$WP=this.$WP||[]).push(["1tbrqz",(e,i)=>{"use strict";var t,o,a,l,n,r,d,s,c,u,h,v,p,m,_,E,g,R,C,T,w,I,S,y,N,f,b,P,k,A,O,U,D,M,L,V,W,z,x,B,H,F,G,Y,q,K,j,$,X,Q,J,Z,ee,ie,te,oe,ae,le,ne,re,de,se,ce,ue,he,ve,pe,me,_e,Ee,ge,Re,Ce,Te,we,Ie,Se,ye,Ne,fe,be,Pe,ke,Ae,Oe,Ue,De,Me,Le,Ve,We,ze,xe,Be={__key:91548404097567,id:"5343461b221f81c1a5ad0fb4ef3f4fda",loc:{},definitions:[]},He=e=>{var i=e.map((e=>e.id)),[{data:t,error:a},l]=_({requestPolicy:"network-only",query:Be,variables:{photoIds:i},pause:0===e.length});return{photos:o((()=>{var i=null==t?void 0:t.photos;return a||0===e.length?[]:(null==i?void 0:i.filter(Boolean).map((e=>{var i;return{id:(null==e?void 0:e.id)||0,caption:(null==e?void 0:e.caption)||"",categoryId:null,source:(null==e||null==(i=e.photoSizes)?void 0:i.filter((e=>e&&e.url&&e.width&&e.height)).map((e=>({url:(null==e?void 0:e.url)||"",width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0}))))||[]}})))||[]}),[e,t,a]),refetch:l}};function Fe(e,i){if(i&&e){var t=i.match(/\b(\w+)\b/g),o=null==t?void 0:t.map((e=>e.toLowerCase())),a=new Set(e),l=new Set(null==o?void 0:o.filter((e=>a.has(e))));return(null==l?void 0:l.size)>0}return!1}var Ge={__key:34789774465105,id:"1fa420261851c634f3095a8a0797ec69",loc:{},definitions:[]},Ye=({children:e,photos:i,onChange:t,tracking:n,isHotel:r})=>{var[d,s]=a([]),[c,u]=a(!1),{photos:h}=de(i),v=l((e=>{var i=e.map((({id:e,caption:i,categoryId:t,hasProfanity:o,profanityTokens:a})=>({id:e,caption:i,categoryId:t,hasProfanity:o,profanityTokens:a})));t&&t(i)}),[t]),p=l((e=>null!=e&&e.originalPhoto?e:{originalPhoto:e}),[]),m=l((e=>{s("function"==typeof e?i=>e(i):e.map(p))}),[p]),_=l((e=>{u(e)}),[u]),R=o((()=>i.map((e=>{var i;return{...e,hasProfanity:Fe((null==e?void 0:e.profanityTokens)||null,(null==e?void 0:e.caption)||null),source:(null==(i=h.find((i=>i.id===e.id)))?void 0:i.source)||[]}}))),[i,h]),C=o((()=>"boolean"!=typeof c?c:[]),[c]),[,T]=E(Ge),w=l(((e,i,t,o,a)=>{var l;if(null!=(l=e[a])&&l.caption){var n={checks:new Array("PROFANITY"),text:e[a].caption};T({textsToModerate:[n]}).then((l=>{!function(l){var n,r,d,s=null==(n=l.data)?void 0:n.TextPreModeration_moderateBatchV2;if(1===(null==s?void 0:s.length))if("NOT_OK"===(null==(r=s[0])?void 0:r.decision)&&null!=(d=s[0].results)&&d.some((e=>"PROFANITY"===(null==e?void 0:e.check)&&"PRESENT"===e.classification))){var c,u=null==(c=s[0].results.find((e=>"PROFANITY"===(null==e?void 0:e.check)&&"PRESENT"===e.classification)))?void 0:c.tokens,h=e.map((i=>{var t;return i.id===(null==(t=e[a])?void 0:t.id)?{...i,hasProfanity:null!=u,profanityTokens:u}:i}));i(h)}else t(o);else t(o)}(l)}))}else t(o)}),[T]),I=l(((e,i,t,o)=>{var a=e.map((e=>({checks:new Array("PROFANITY"),text:e.caption})));null!=a&&a.some((e=>{var i;return(null==e||null==(i=e.text)?void 0:i.length)>0}))?T({textsToModerate:a}).then((a=>{!function(a){var l,n=null==(l=a.data)?void 0:l.TextPreModeration_moderateBatchV2;if(n){var r=new Array;n.forEach(((i,t)=>{var o,a,l=null==i||null==(o=i.results)||null==(a=o.find((e=>"PROFANITY"===(null==e?void 0:e.check)&&"PRESENT"===e.classification)))?void 0:a.tokens;r.push({...e[t],hasProfanity:null!=l,profanityTokens:l})})),i(r)}else t(o)}(a)})):t(o)}),[T]),S=l(((e,t=(()=>{}),o=null,a=null)=>a?w(i,e,t,o,a):I(i,e,t,o)),[w,I,i]),y=o((()=>({photos:R,setPhotos:v,croppingPhotos:d,setCroppingPhotos:m,uploadModalOpenState:c,uploadModalMobilePhotoIds:C,setUploadModalOpenState:_,checkForCaptionProfanity:S,tracking:n,isHotel:r})),[d,v,m,n,r,R,c,C,_,S]);return g(se.Provider,{value:y,children:e})},qe=20,Ke=({imageSize:e,cropCoordinates:i,setCropCoordinates:t,children:o})=>{var[l,r]=a(null),[d]=a(ue.map((()=>n()))),s=(e,i,t)=>e<i?i:e>t?t:e,c=(o,a,l)=>{if(null!==l&&e){var{horizontalPosition:n,verticalPosition:r}=ue[l],d="right"===n?"width":"left",c="bottom"===r?"height":"top",u={...i,[d]:i[d]+o,[c]:i[c]+a,...n&&"left"===n&&{width:i.width-o},...r&&"top"===r&&{height:i.height-a}};if(u.width>qe&&u.height>qe){var h=!n&&!r;u={top:s(u.top,0,e.height-(h?u.height:qe)),left:s(u.left,0,e.width-(h?u.width:qe)),width:h?u.width:s(u.width,qe,e.width-u.left),height:h?u.height:s(u.height,qe,e.height-u.top)},t(u)}}},u=e=>{if(null!=l){var i=d[l].current;if(i){var{horizontalPosition:t,verticalPosition:o}=ue[l],a=e.clientX-i.getBoundingClientRect().left,n=e.clientY-i.getBoundingClientRect().top;c(!t&&o?0:a,!o&&t?0:n,l)}}},h=()=>{null!=l&&r(null)};return e?R("div",{onTouchMove:e=>{null!=l&&1===e.touches.length&&u(e.touches[0])},onTouchEnd:h,onMouseMove:e=>{null!=l&&(e.preventDefault(),u(e))},onMouseLeave:e=>{null!=l&&(u(e),h())},onMouseUp:h,role:"presentation",tabIndex:-1,className:"YVPpE",children:[g("div",{className:"xDUbl Z1",style:i,children:ue.map((({horizontalPosition:e,verticalPosition:i},t)=>g(he,{ref:d[t],verticalPosition:i,horizontalPosition:e,index:t,handleDragEnd:h,handlePointMovement:c,setMovingPointIndex:r},`${e||""} ${i||""}`)))}),g("div",{className:"TFcIN o",children:g("div",{className:"LAGYZ z",style:i})}),g("div",{children:o})]}):o},je=[{name:"3:4",factor:3/4},{name:"1:1",factor:1},{name:"4:3",factor:4/3}],$e=e=>({options:o((()=>{if(!e)return[];var i=e.width/2,t=e.height/2;return je.map((o=>{var a=Math.min(e.width,e.height),l=a*o.factor,n=Math.max(e.width,e.height);l>n&&(a=(l=n)/o.factor);var r=e.height>e.width?l:a,d=e.height>e.width?a:l;return{...o,value:{left:i-d/2,top:t-r/2,width:d,height:r}}}))}),[e]),isOptionActive:(e,i)=>!!e&&i.value.top===e.top&&i.value.left===e.left&&i.value.width===e.width&&i.value.height===e.height}),Xe=({image:e,setImage:i,onClose:t,setCropCoordinates:o,resetCrop:a,getCropOptionIcon:l,cropImages:n})=>{var{localize:r}=w(),{tracking:u}=d(se),h=s(null),v=s(null),{options:p,isOptionActive:m}=pe(null==e?void 0:e.imageSize);return c((()=>{var t=v.current;!h.current&&e?(h.current=new ResizeObserver((()=>{if(null!=v&&v.current&&void 0!==e){var t,o,{height:a,width:l}=v.current.getBoundingClientRect();0!==l&&0!==a&&(null==(t=e.imageSize)?void 0:t.width)!==l&&(null==(o=e.imageSize)?void 0:o.height)!==a&&i({...e,imageSize:{width:l,height:a},cropCoordinates:{...Ee,width:l,height:a}})}})),t&&null!=h&&h.current&&h.current.observe(t)):null!=h&&h.current&&void 0===e&&t&&(h.current.unobserve(t),h.current=null)}),[v,h,e,i]),R(k,{onClose:t,children:[g(P,{marginBottom:"spacing-04",variant:"title-02",children:r.string("user_review_crop_photo")}),R("div",{className:"f",children:[g("div",{className:"IGWiO Gp f u",children:g("div",{ref:v,children:g(ve,{imageSize:null==e?void 0:e.imageSize,cropCoordinates:(null==e?void 0:e.cropCoordinates)||Ee,setCropCoordinates:e=>{null!=u&&u.onCropPhotoModalCropSizeChange&&u.onCropPhotoModalCropSizeChange(),o(e)},children:g("div",{className:"uEckD",children:g(y,{source:null==e?void 0:e.originalPhoto.source,height:"100%"})})})})}),R("div",{className:"ToTHp PM f e",children:[g("div",{className:"iOajs f",children:p.map((i=>g(A,{dataAttributes:{"data-automation":`crop-photo-${i.name}-button`},onClick:()=>{null!=u&&u.onCropPhotoModalCropSizeClick&&u.onCropPhotoModalCropSizeClick(i.name),o(i.value)},marginLeft:"spacing-02",selected:m(null==e?void 0:e.cropCoordinates,i),children:g(P,{variant:"button-03",children:R("div",{className:"vEvEN f e u c",children:[g("div",{className:"SmzWy",children:l(i.factor)}),g("span",{children:i.name})]})})},i.name)))}),R("div",{className:"jbanq f u",children:[g(f,{onClick:()=>{null!=u&&u.onCropPhotoModalCropReset&&u.onCropPhotoModalCropReset(),a()},dataAttributes:{"data-automation":"reset-crop-button"},children:r.string("user_review_reset_crop")}),g(N,{dataAttributes:{"data-automation":"save-crop-button"},variant:"secondary",onClick:n,children:r("btn_save")})]})]})]})]})},Qe="TBuUg Gp f u",Je="QnhiX",Ze=({image:e,setImage:i,onClose:t,setCropCoordinates:l,resetCrop:n,getCropOptionIcon:r,cropImages:u})=>{var{localize:h}=w(),{croppingPhotos:v,tracking:p}=d(se),m=o((()=>v.filter((e=>!(null!=e&&e.processed)))),[v]),[_,E]=a(0),C=s(null),T=s(null),I=s(null),{options:S,isOptionActive:b}=pe(null==e?void 0:e.imageSize);c((()=>{var t=T.current;!C.current&&e?(C.current=new ResizeObserver((()=>{if(null!=T&&T.current&&void 0!==e){var t,o,{height:a,width:l}=T.current.getBoundingClientRect();0!==l&&0!==a&&(null==(t=e.imageSize)?void 0:t.width)!==l&&(null==(o=e.imageSize)?void 0:o.height)!==a&&i({...e,imageSize:{width:l,height:a},cropCoordinates:{...Ee,width:l,height:a}})}})),t&&null!=C&&C.current&&C.current.observe(t)):null!=C&&C.current&&void 0===e&&t&&(C.current.unobserve(t),C.current=null)}),[T,C,e,_,i]),c((()=>{var t;if(m.length>0)if(void 0===e){var o=m[_];if(o)i(o);else{var a=m.findIndex((e=>!e.deleted));-1!==a&&E(a)}}else(null==(t=m[_])?void 0:t.originalPhoto.id)!==(null==e?void 0:e.originalPhoto.id)&&i(void 0)}),[_,e,m,i,E]);var U=o((()=>50*m.length+8*(m.length-1)),[m.length]),D=e=>{E(e),null!=I&&I.current&&I.current.scroll({left:58*e,behavior:"smooth"})};return g(k,{variant:"fixed-height-sticky-footer",stickyHeader:!0,onClose:t,title:R("div",{className:"ErUsv f",children:[g(f,{onClick:()=>{null!=p&&p.onCropPhotoModalCropReset&&p.onCropPhotoModalCropReset(),n()},dataAttributes:{"data-automation":"reset-crop-button"},children:h.string("user_review_reset_crop")}),g("div",{className:"XwuHV f",children:S.map((i=>g(A,{dataAttributes:{"data-automation":`crop-photo-${i.name}-button`},onClick:()=>{null!=p&&p.onCropPhotoModalCropSizeClick&&p.onCropPhotoModalCropSizeClick(i.name),l(i.value)},marginLeft:"spacing-02",selected:b(null==e?void 0:e.cropCoordinates,i),children:g(P,{variant:"button-03",children:R("div",{className:"XLghM f e u c",children:[g("div",{className:"jtwBK",children:r(i.factor)}),g("span",{children:i.name})]})})},i.name)))})]}),footer:R("div",{className:"Gzfal f e",children:[m.length>1&&g("div",{ref:I,className:"vpmPK _h",children:g("div",{style:{width:U},className:"vJoAb",children:m.map(((e,i)=>e.deleted?null:g("div",{onClick:()=>{D(i)},role:"button",onKeyDown:e=>{"Enter"===e.key&&D(i)},tabIndex:0,children:g("div",{className:O(Qe,{"ccqJd z":i===_}),children:g("div",{className:Je,children:g(y,{source:e.originalPhoto.source,height:"100%"})})})},e.originalPhoto.id)))})}),R("div",{className:"qPglN f u",children:[g(N,{dataAttributes:{"data-automation":"remove-photo-button"},variant:"secondary",onClick:()=>{e&&i({...e,deleted:!0,processed:!0})},children:h("user_review_crop_photo_remove")}),g(N,{dataAttributes:{"data-automation":"save-crop-button"},onClick:u,children:h("btn_save")})]})]}),children:g("div",{className:Qe,children:g("div",{ref:T,children:g(ve,{imageSize:null==e?void 0:e.imageSize,cropCoordinates:(null==e?void 0:e.cropCoordinates)||Ee,setCropCoordinates:e=>{null!=p&&p.onCropPhotoModalCropSizeChange&&p.onCropPhotoModalCropSizeChange(),l(e)},children:g("div",{className:Je,children:g(y,{source:null==e?void 0:e.originalPhoto.source,height:"100%"})})})})})})},ei={width:0,height:0},ii=()=>{var{setCroppingPhotos:e,croppingPhotos:i,tracking:t}=d(se),[o,n]=a(i[0]),r=s([]),u="MOBILE"===m(),h=l((()=>{null!=t&&t.onCropPhotoModalClose&&t.onCropPhotoModalClose(),e([])}),[t,e]),v=e=>{void 0!==o&&n({...o,cropCoordinates:e})};return c((()=>{var t=i.find((e=>e.originalPhoto.id===(null==o?void 0:o.originalPhoto.id)));o&&t&&!U(o,t)&&e(i.map((e=>e.originalPhoto.id===o.originalPhoto.id?o:e)))}),[o,i,e]),R(C,{children:[g(u?_e:me,{image:o,setImage:n,setCropCoordinates:v,onClose:h,cropImages:()=>{i.forEach(((i,t)=>{i.deleted||((i,t)=>{var{cropCoordinates:o,originalPhoto:a,imageSize:l}=i,n=r.current[t];if(n&&o&&l&&(0!==o.top||0!==o.left||o.height!==l.height||o.width!==l.width)){e((e=>e.map(((e,i)=>i===t?{...e,processed:!1}:e))));var{url:d,width:s}=a.source[a.source.length-1],c=s/l.width,u=o.width*c,h=o.height*c;n.width=u,n.height=h;var v=new Image;v.crossOrigin="",v.addEventListener("load",(()=>{var i=n.getContext("2d");i&&(i.clearRect(0,0,o.width,o.height),i.drawImage(v,o.left*c,o.top*c,o.width*c,o.height*c,0,0,u,h),n.toBlob((i=>{if(i){var o=i;o.lastModified=(new Date).getTime(),o.name=`${a.id}_crop.png`,e((e=>e.map(((e,i)=>i===t?{...e,file:o,processed:!0}:e))))}}),void 0,1))})),v.setAttribute("src",d)}else e((e=>e.map(((e,i)=>i===t?{...e,processed:!0}:e))))})(i,t)}))},getCropOptionIcon:e=>g("div",{className:"AzHsi",style:{width:e>1?8*e:8,height:e>1?8:8/e}}),resetCrop:()=>{var e,i;return v({...Ee,height:(null==o||null==(e=o.imageSize)?void 0:e.height)||ei.height,width:(null==o||null==(i=o.imageSize)?void 0:i.width)||ei.width})}}),g("div",{className:"_",children:i.map(((e,i)=>e.deleted?null:g("canvas",{ref:e=>{r.current[i]=e}},e.originalPhoto.id)))})]})},ti=()=>{var{localize:e}=w();return[{value:"16",displayName:e.string("war_hotel_photo_category_dining")},{value:"17",displayName:e.string("war_hotel_photo_category_hotel_and_ground")},{value:"18",displayName:e.string("war_hotel_photo_category_room")},{value:"19",displayName:e.string("war_hotel_photo_category_bathroom")},{value:"20",displayName:e.string("war_hotel_photo_category_pool")},{value:"21",displayName:e.string("war_hotel_photo_category_view")},{value:"22",displayName:e.string("war_hotel_photo_category_family_area")},{value:"23",displayName:e.string("war_hotel_photo_category_buisness_center")},{value:"100",displayName:e.string("war_hotel_photo_category_other")}]},oi="EOWdL",ai=({onClose:e,onSave:i})=>{var t,n,{localize:r}=w(),{photos:u,setPhotos:h,setCroppingPhotos:v,setUploadModalOpenState:p,isHotel:m,tracking:_,uploadModalMobilePhotoIds:E,checkForCaptionProfanity:C}=d(se),[T,I]=a(null),[S,f]=a(0),U=s(null),W=Re(),z=u.find((e=>e.id===E[S]));c((()=>{0===E.length&&p(!1)}),[E.length,p]);var x=l((()=>{v(u.filter((e=>E.includes(e.id))))}),[u,E,v]),B=o((()=>{var e=u.find((e=>e.id===(null==z?void 0:z.id)));return null!=e&&e.hasProfanity?r.string("phoenix_war_profanity_error_message"):null}),[u,z,r]),H=l((e=>{h(e)}),[h]);return g(k,{variant:"fixed-height-sticky-footer",stickyHeader:!0,title:R("div",{className:"kSqYi",children:[g("div",{className:"SZBYP c",children:g(P,{variant:"title-04",children:1===E.length?r.string("user_review_add_caption_title"):r.string("user_review_add_captions_title",{index:S+1,count:E.length})})}),g(b,{variant:"clear",icon:V,"aria-label":r.string("common_Close"),size:"small",onClick:e})]}),footer:R("div",{className:"VthlD u",children:[g("div",{className:oi,children:T&&r("ds_textarea_maximum_characters",{numCount:(null==(t=u.find((e=>e.id===T)))||null==(n=t.caption)?void 0:n.length)||0,numLimit:ni})}),g("div",{className:oi,children:g(N,{variant:"secondary",dataAttributes:{"data-automation":"next-photo-button"},onClick:S===E.length-1?i:()=>{f(S+1)},children:S===E.length-1?r.string("tavrs_common_save"):r.string("common_Next")})})]}),onClose:e,closeButtonPosition:"none",children:R("div",{className:"vYDSu",children:[g("div",{onClick:()=>{null!=_&&_.onPhotoClick&&_.onPhotoClick(),x()},role:"button",onKeyDown:e=>{"Enter"===e.key&&(null!=_&&_.onPhotoClick&&_.onPhotoClick(),x())},tabIndex:0,"data-automation":`crop-photo-${S}-modal-button`,children:g("div",{className:"hEQrs _S u",children:g("div",{className:"pGmMM",children:g(y,{errorRefetchOptions:{interval:2e3,maxCount:30},source:null==z?void 0:z.source,height:"100%"})})})}),m&&R("div",{children:[g(P,{marginTop:"spacing-03",marginBottom:"spacing-03",variant:"title-03",children:r.string("war_photos_category_selection_placeholder")}),g(L,{mode:"select",label:r.string("war_photos_category_selection_chooseone"),trigger:e=>{var i;return g(A,{icon:e.active?D:M,iconPosition:"trailing",onKeyDown:e.onKeyDown,onClick:e.onClick,disabled:e.disabled,...e.ariaAttributes,ref:e.ref,children:""!==e.children?e.children:null!=(i=e.placeholder)?i:null})},placeholder:r.string("war_photos_category_selection_chooseone"),value:String(null==z?void 0:z.categoryId),options:W,onChange:e=>{var i=u.map((i=>i.id===(null==z?void 0:z.id)?{...z,categoryId:+e}:i));h(i)}})]}),g(P,{marginTop:"spacing-04",variant:"title-03",children:r.string("user_review_add_caption_label")}),g(P,{marginTop:"spacing-03",variant:"body-01",children:g("textarea",{id:`photo-${S}-caption`,className:O("CZyrh Q _g z R4 Cj",{BvmxG:B}),ref:U,onFocus:()=>I((null==z?void 0:z.id)||null),placeholder:r.string("user_review_add_caption"),rows:5,onBlur:()=>{!B&&null!=z&&z.caption&&C(H,(()=>{}),void 0,S)},onChange:e=>{var i=e.target.value;if(e.target.value.length<=ni){null!=_&&_.onAddCaption&&_.onAddCaption(i);var t=u.map((i=>i.id===(null==z?void 0:z.id)?{...z,caption:e.target.value}:i));h(t)}},value:(null==z?void 0:z.caption)||"",maxLength:ni})}),B&&g("div",{className:"dugTi",role:"alert","aria-controls":`photo-${S}-caption`,children:g(P,{variant:"supporting-02",color:"dangerText",marginTop:"spacing-02",children:B})})]})})},li=({onClose:e,onSave:i})=>{var{localize:t}=w(),{photos:r,setPhotos:s,setCroppingPhotos:u,isHotel:v,tracking:p,setUploadModalOpenState:m,checkForCaptionProfanity:_}=d(se),{open:E}=h(),{termsOfUse:C}=x(),[T,S]=a(null),f=Re(),O=o((()=>r.map((()=>n()))),[r]),U=l((e=>{e.current&&e.current.scrollIntoView({behavior:"smooth"})}),[]),[z,B]=a("CheckProfanity"),H=l((e=>{B("CloseModal"),i(),e&&e.target.dispatchEvent(new Event("click"))}),[B,i]),F=l((e=>{s(e);var i=e.findIndex((e=>e.hasProfanity));i>-1&&i<O.length?U(O[i]):H()}),[s,O,U,H]);c((()=>{0===r.length&&m(!1)}),[r.length,m]);var[G,Y]=a(!1),q=l((()=>{var e=r.findIndex((e=>null==e?void 0:e.hasProfanity));e>-1&&e<O.length&&U(O[e])}),[r,U,O]);return c((()=>{G||q(),Y(!0)}),[G,q]),g(k,{variant:"fixed-height-sticky-footer",stickyHeader:!0,title:g("div",{className:"HIRRr",children:g(P,{variant:"title-02",children:t.string("user_review_add_photos")})}),footer:R("div",{className:"UaYji e",children:[R("div",{className:"CnloW",children:[g(N,{variant:"secondary",dataAttributes:{"data-automation":"add-more-photos-button"},onClick:()=>{null!=p&&p.onAddMoreClick&&p.onAddMoreClick(),E()},children:g("div",{className:"cenCM u",children:t.string("user_review_add_more_photos")})}),g(N,{dataAttributes:{"data-automation":"attach-photos-button"},onClick:e=>{"CheckProfanity"===z?(e.preventDefault(),_(F,H,e)):B("CheckProfanity")},children:1===r.length?t.string("user_review_attach_photo"):t.string("user_review_attach_photos",{number:r.length})})]}),g(P,{variant:"supporting-02",children:g(I,{id:"user_review_photo_upload_terms_with_url",args:{link:`"${C}"`,class:'"bzvTa _F Wb"',target:'"_blank"'}})})]}),onClose:e,children:g("div",{className:"ZUCuS",children:g("div",{className:"sBBXd",children:r.map(((e,i)=>{var o,a,l,n;return R("div",{ref:O[i],className:"gAxKd u",children:[g("div",{onClick:()=>{null!=p&&p.onPhotoClick&&p.onPhotoClick(),u([e])},role:"button",onKeyDown:i=>{"Enter"===i.key&&(null!=p&&p.onPhotoClick&&p.onPhotoClick(),u([e]))},tabIndex:0,"data-automation":`crop-photo-${i}-modal-button`,children:R("div",{className:"YmmrD _S u o",children:[g("div",{className:"FtTTq",children:g(b,{dataAttributes:{"data-automation":`delete-photo-${i}-modal-button`},variant:"dark",icon:V,"aria-label":t.string("b2b_delete_photo"),size:"small",onClick:e=>{null!=p&&p.onDeletePhoto&&p.onDeletePhoto(),((e,i)=>{e.preventDefault(),e.stopPropagation();var t=[...r];t.splice(i,1),s(t)})(e,i)}})}),g("div",{className:"ATXuz",children:g(y,{errorRefetchOptions:{interval:2e3,maxCount:30},source:null==r||null==(o=r.find((i=>i.id===e.id)))?void 0:o.source,height:"100%"})})]})}),R("div",{className:"btHwj PF",children:[" ",v&&g("div",{className:"TxjNf",children:g(L,{mode:"select",label:t.string("war_photos_category_selection_placeholder"),trigger:e=>{var i;return g(A,{icon:e.active?D:M,iconPosition:"trailing",onKeyDown:e.onKeyDown,onClick:e.onClick,disabled:e.disabled,...e.ariaAttributes,ref:e.ref,children:""!==e.children?e.children:null!=(i=e.placeholder)?i:null})},placeholder:t.string("war_photos_category_selection_placeholder"),value:String(e.categoryId),options:f,onChange:e=>{var t=r.map((t=>t.id===r[i].id?{...r[i],categoryId:+e}:t));s(t)}})}),g(W,{id:`photo-${i}-caption`,state:null!=(a=r[i])&&a.hasProfanity?"error":void 0,errorText:null!=(l=r[i])&&l.hasProfanity?t.string("phoenix_war_profanity_error_message"):void 0,marginTop:"spacing-02",placeholder:t.string("user_review_add_caption"),value:null==(n=r[i])?void 0:n.caption,onBlur:()=>S(null),onFocus:()=>S(e.id),onChange:e=>{var t=e.target.value;null!=p&&p.onAddCaption&&p.onAddCaption(t);var o=r.map((t=>t.id===r[i].id?{...r[i],caption:e.target.value}:t));s(o)},maxLength:ni,characterCountType:T===e.id?"max":void 0,variant:"two-line"})]})]},e.id)}))})})})},ni=300,ri=()=>{var{croppingPhotos:e,tracking:i,setUploadModalOpenState:t}=d(se),a="MOBILE"===m(),n=o((()=>e.length>0),[e]);c((()=>{n&&null!=i&&i.onCropPhotoModalOpen&&i.onCropPhotoModalOpen()}),[n,i]);var r=l((()=>{t(!1)}),[t]),s=l((()=>{null!=i&&i.onUploadModalSave&&i.onUploadModalSave(),r()}),[r,i]),u=l((()=>{null!=i&&i.onCloseClick&&i.onCloseClick(),r()}),[r,i]);return n?g(ge,{}):g(a?Ce:Te,{onSave:s,onClose:u})},di=({onPhotoDelete:e,openAddPhotosModal:i,openPhotoUpload:t})=>{var{photos:a}=d(se),{localize:l}=w(),n=o((()=>{var e=null;return null!=a&&a.some((e=>null==e?void 0:e.hasProfanity))&&(e=l.string("phoenix_war_profanity_error_message")),e}),[a,l]);return R(C,{children:[g(P,{variant:"title-03",marginBottom:"spacing-01",children:l("tavrs_common_photos_v2")}),g(P,{color:"placeholderText",variant:"body-01",marginBottom:"spacing-04",children:l("phoenix_war_optional_tag")}),a&&R(C,{children:[g("div",{className:"SvvNP Ml",children:a.map(((i,t)=>{var o;return R("div",{className:"dNoUj j u o",children:[g("div",{className:"sIgIH",children:g(b,{variant:"dark",icon:V,"aria-label":l.string("b2b_delete_photo"),size:"small",onClick:i=>{i.stopPropagation(),e(t)},dataAttributes:{"data-automation":`delete-photo-${t}-button`}})}),g("div",{className:"AFkzX",children:g(y,{errorRefetchOptions:{interval:2e3,maxCount:30},source:null==a||null==(o=a.find((e=>e.id===i.id)))?void 0:o.source,height:"100%"})})]},i.id)}))}),(null==a?void 0:a.length)>0&&g(f,{marginTop:"spacing-03",onClick:()=>i(),dataAttributes:{"data-automation":"edit-captions-button"},children:l.string("user_review_edit_captions_v2")})]}),n&&g("div",{className:"PgMSe",role:"alert",children:g(P,{variant:"supporting-02",color:"dangerText",marginTop:"spacing-02",children:n})}),R("div",{className:"IytWu e u Ml _S",role:"button",onKeyDown:e=>{"Enter"===e.key&&t()},tabIndex:0,onClick:t,"data-automation":"photo-upload-trigger",children:[g(B,{size:18}),g(P,{marginTop:"spacing-02",variant:"supporting-03",children:l.string("user_review_click_add_photos")}),g(P,{marginTop:"spacing-01",variant:"supporting-02",children:l.string("user_review_drag_drop")})]})]})},si=({onPhotoDelete:e,openAddPhotosModal:i,openPhotoUpload:t})=>{var{photos:a}=d(se),{localize:l}=w(),n=o((()=>{var e=null;return null!=a&&a.some((e=>null==e?void 0:e.hasProfanity))&&(e=l.string("phoenix_war_profanity_error_message")),e}),[a,l]);return R(C,{children:[g(P,{variant:"title-03",marginBottom:"spacing-01",children:l("tavrs_common_photos_v2")}),g(P,{color:"placeholderText",variant:"body-01",marginBottom:"spacing-04",children:l("phoenix_war_optional_tag")}),a&&g("div",{className:"OnUFF Ma _h",children:g("div",{className:"wCQGj f",children:a.map(((t,o)=>{var n;return R("div",{role:"button",onKeyDown:e=>{"Enter"===e.key&&i([t.id])},tabIndex:0,onClick:()=>{i([t.id])},children:[R("div",{className:"xznnE f j u",children:[g("div",{className:"LcTjP",children:g(b,{variant:"dark",icon:V,"aria-label":l.string("b2b_delete_photo"),size:"small",onClick:i=>{i.stopPropagation(),e(o)},dataAttributes:{"data-automation":`delete-photo-${o}-button`}})}),g("div",{className:"YzKak",children:g(y,{errorRefetchOptions:{interval:2e3,maxCount:30},source:null==a||null==(n=a.find((e=>e.id===t.id)))?void 0:n.source,height:"100%"})})]}),g(P,{variant:"body-01",children:g("div",{className:"EKaXr W f j u",children:g(f,{marginY:"spacing-03",trailing:!0,icon:t.caption?H:void 0,onClick:()=>{i([t.id])},dataAttributes:{"data-automation":`add-caption-${o}-button`},children:t.caption?g("span",{className:O("EZZQY",{wvTLn:null==t?void 0:t.hasProfanity}),children:null==t?void 0:t.caption}):l.string("user_review_add_caption_title")})})})]},t.id)}))})}),n&&g("div",{className:"ifcjl",role:"alert",children:g(P,{variant:"supporting-02",color:"dangerText",marginTop:"spacing-02",children:n})}),R("div",{className:O("oRZOK f e u _S j",{EGPhi:(null==a?void 0:a.length)>0}),role:"button",onKeyDown:e=>{"Enter"===e.key&&t()},tabIndex:0,onClick:t,"data-automation":"photo-upload-trigger",children:[g(B,{size:18}),g(P,{marginTop:(null==a?void 0:a.length)>0?void 0:"spacing-02",variant:"supporting-03",children:(null==a?void 0:a.length)>0?l.string("user_review_add_more_photos"):l.string("user_review_add_photos")})]})]})},ci=({onClose:e})=>{var{localize:i}=w();return g(k,{onClose:e,children:g("div",{"data-automation":"photo-upload-loading",className:"leagN",children:R("div",{className:"hTEdJ Mk Nb MJ NC f u e z",children:[g(P,{variant:"title-03",marginBottom:"spacing-01",children:i.string("user_review_uploading_photos")}),g(F,{variant:"large","aria-label":"Loading large"})]})})})},ui=()=>{var{photos:e,croppingPhotos:i,setPhotos:t,setCroppingPhotos:n,uploadModalOpenState:r,setUploadModalOpenState:s,tracking:u,checkForCaptionProfanity:v}=d(se),p="MOBILE"===m(),{photos:_,open:E,uploadFiles:T}=h((o=>{if(i.length>0)y(o.map((e=>e.mediaId)));else{var a=[...e,...o.map((({mediaId:e})=>({id:e,caption:"",categoryId:null})))];t(a)}})),w=o((()=>_.length>0||(null==i?void 0:i.some((e=>!1===(null==e?void 0:e.processed))))),[_.length,i]),I=l((()=>{s(!1)}),[s]),S=l((()=>{null!=u&&u.onCloseClick&&u.onCloseClick(),I()}),[I,u]),y=l(((o=[])=>{if(i){null!=u&&u.onCropPhotoModalSave&&u.onCropPhotoModalSave();var a=0,l=[],d=e.map((e=>{var t=i.find((i=>i.originalPhoto.id===e.id));if(null!=t&&t.deleted)return null;if(null!=t&&t.file){var n=o[a++];return l.push(n),{id:n,caption:t.originalPhoto.caption,categoryId:t.originalPhoto.categoryId}}return"boolean"!=typeof r&&r.includes(e.id)&&l.push(e.id),e})).filter(Boolean);t(d),n([]),"boolean"!=typeof r&&s(l)}}),[u,i,n,e,t,s,r]);c((()=>{null!=u&&u.onModalOpen&&r&&u.onModalOpen()}),[u,r]),c((()=>{_.length>0&&!r&&s(!p||[])}),[_.length,r,s,p]),c((()=>{I()}),[p,I]),c((()=>{if(0===_.length&&i.length>0&&i.every((e=>null==e?void 0:e.processed))){var e=i.map((e=>null==e?void 0:e.file)).filter(Boolean);e.length>0?T(e):y()}}),[y,i,_,T]);var N=l((e=>{t(e)}),[t]),[f,b]=a(!0);return c((()=>{r?b(!0):f&&(b(!1),v(N))}),[r,b,f,v,N]),R(C,{children:[w&&g(ye,{onClose:S}),!!r&&!w&&g(we,{}),g(p?Se:Ie,{onPhotoDelete:i=>{var o=e||[];o.splice(i,1),t(o)},openAddPhotosModal:(e=!0)=>{s(e)},openPhotoUpload:()=>{null!=u&&u.onDropzoneClick&&u.onDropzoneClick(),E()}})]})},hi=({onClose:e,onReselect:i,variant:t})=>{var{localize:o}=w();return g(k,{onClose:e,title:o.string("user_review_add_photos_limit_title"),primaryButton:g(N,{variant:"primary",onClick:e,children:o.string("aw_done_ffffe1e5")}),secondaryButton:i?g(N,{variant:"secondary",onClick:i,children:o.string("user_review_add_photos_limit_secondary_cta")}):void 0,children:R(P,{variant:"body-01",children:["RATE_LIMITED"===t&&o.string("user_review_add_photos_rate_limited_text"),"LIMIT_REACHED"===t&&o.string("user_review_add_photos_limit_reached_text",{limit:50})]})})},vi=({locationId:e})=>{var{photos:i,croppingPhotos:t}=d(se),[o,n]=a(null),r=l((e=>{if(((null==t?void 0:t.length)||0)>0)return!0;var o=i.length+e>50;return o&&n({variant:"LIMIT_REACHED"}),!o}),[i.length,t]),s=l((e=>{n({variant:"RATE_LIMITED",onReselect:()=>{e(),n(null)}})}),[]);return g(u,{children:g(p,{children:R(v,{mediaType:"photo",timeout:6e4,retryCount:2,locationId:e,pid:459,pidAttr:"UserReviewEdit",isForUserReview:!0,isAllowedNonLoggedInUpload:!0,onRateLimitedError:s,beforePhotoUploadCheck:e=>r(e.length),children:[g(Ne,{}),o&&g(fe,{variant:o.variant,onReselect:null==o?void 0:o.onReselect,onClose:()=>n(null)})]})})})},pi=({photoObjects:e,tracking:i,isHotel:t,onPhotosUploadedWithObject:o,locationId:a})=>g(ce,{photos:e,tracking:i,isHotel:t,onChange:o,children:g(vi,{locationId:a})}),mi="YUuQs",_i="o W q",Ei=e=>{var i,{locationTitle:t,locationSubtitle:o,thumbnails:l,rating:n,variant:r,useCardStyle:d,upvotes:s,menuActions:c,onRatingClick:u,onCardClick:h,link:v}=e,{localize:p}=w(),[m,_]=a(n||0),E=g("div",{className:d?"UEqmh Gi Pj PX Pw PJ":void 0,children:R("div",{className:"BlJbG",children:[l&&"imageLeft"===r&&g("div",{className:"uSrYC",children:g(y,{source:null==(i=l[0])?void 0:i.source,height:"100%",width:"100%",aspectRatio:"1:1"})}),R("div",{className:"I",children:[R("div",{className:mi,children:[g("div",{className:"o",children:g(P,{variant:"title-04",children:g("div",{className:_i,children:t})})}),c&&g("div",{className:"xgqOf",children:g("div",{className:"BMEVx",children:g(L,{options:c,menuVariant:"trailing-top-caret",label:p.string("sng_review_options"),mode:"menu",fullscreenMobile:!0,trigger:({active:e,onKeyDown:i,ariaAttributes:t,ref:o,onClick:a})=>g(b,{ref:o,ariaAttributes:t,onKeyDown:e=>{e.preventDefault(),i&&i(e)},variant:"clear",icon:Y,size:"small","aria-label":e?p.string("sng_close_options_menu"):p.string("sng_open_options_menu"),onClick:e=>{e.preventDefault(),a&&a(e),h&&h()}})})})})]}),g("div",{className:mi,children:g("div",{className:"o",children:g(P,{marginY:"spacing-01",variant:"supporting-01",children:g("div",{className:_i,children:o})})})}),u&&g("div",{onClick:e=>e.stopPropagation(),role:"presentation",children:g(q,{name:"Traveler rating",rating:m,showRatingLabel:!1,onClick:(e,i)=>{_(i),u&&u(i),h&&h()},size:"large"})}),void 0!==s&&s>0&&g(P,{marginY:"spacing-01",variant:"supporting-01",children:R("span",{className:"SYFFK u",children:[g(G,{size:14}),p.string("user_review_found_this_helpful",{number:s})]})}),l&&"imagesBelow"===r&&g("div",{className:"yYpQb Mk",children:l.map((e=>g(y,{source:e.source,width:50,height:50},e.id)))})]})]})});return v?g(j,{theme:"none",onClick:()=>{h&&h()},href:v,children:E}):E},gi=({title:e,items:i,options:t,desktopLayoutColumns:l="three-columns",initialItemsToShow:n,itemsToShowMultiplier:r,onShowMoreClick:d})=>{var s,{localize:u}=w(),h="MOBILE"===m(),[v,p]=a(n),_=o((()=>v?i.slice(0,v):i),[i,v]),E=void 0!==v&&i.length>v;return c((()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})}),[h]),R(C,{children:[Array.isArray(e)?(s=e,g("div",{className:"IZNJo _T",children:g("div",{className:"nYPXR",children:s.map((e=>g("span",{children:g(P,{marginBottom:"spacing-04",variant:"title-03",children:e})},e)))})})):g(P,{marginBottom:"spacing-04",variant:"title-03",children:e}),g("div",{className:O("nKQoO",{PLXqA:"two-columns"===l,woNgg:"three-columns"===l}),children:_.map((e=>g(Pe,{...t,...e},e.id)))}),r&&E&&R(f,{onClick:()=>{d&&d(),p(v+r)},marginTop:"spacing-04",children:[u("airm_mobile_show_more")," "]})]})},Ri={__key:0x9eaef4d8c8d,id:"09eaef4d8c8d109b78d6b315c709efb5",loc:{},definitions:[]},Ci={__key:0x6c2b3b469db6,id:"6c2b3b469db6d51fe56c93bd224a1fc7",loc:{},definitions:[]},Ti=e=>{var{photos:i,rating:t,locationId:o,travelDate:a,tripType:l,content:n,title:r,questionsAndAnswers:d}=e;return{rating:t,locationId:o,travelDate:a,tripType:l,content:n,title:r,questionsAndAnswers:d,photoIds:null==i?void 0:i.map((e=>e.id)),photoCaptions:null==i?void 0:i.map((e=>e.caption)),photoCategories:null==i?void 0:i.map((e=>e.categoryId))}},wi=()=>{var[,e]=E(Ci),i="MOBILE"===m(),t=$(),o=S();return l((a=>e({locale:o,taUnique:t,mobile:i,ipAddress:"",...Ti(a)})),[e,o,t,i])},Ii=({desktopLayoutColumns:e,hideBorder:i,title:t,initialItemsToShow:o,itemsToShowMultiplier:a,onCardClick:l})=>{var n,r,d,s,c,u,h=X(),v=Ae(),[{data:p}]=_({query:Ri,variables:{userId:h||""},requestPolicy:"cache-and-network"}),m=(null==p||null==(n=p.ReviewsProxy_getSuggestedLocationsToReviewForUser)||null==(r=n[0])||null==(d=r.suggestedLocations)||null==(s=d.flat())||null==(c=s.filter(Boolean))||null==(u=c.filter((e=>null==e?void 0:e.locationId)))?void 0:u.map((e=>{var i,t,o,a,l,n,r;return{id:e.locationId,locationTitle:g(j,{theme:"standalone",target:"_blank",href:(null==(i=e.location)?void 0:i.url)||"",children:null==(t=e.location)?void 0:t.localizedName}),locationSubtitle:null==(o=e.location)||null==(a=o.parent)||null==(l=a.additionalNames)?void 0:l.long,writeUserReviewUrl:null==(n=e.location)?void 0:n.writeUserReviewUrl,thumbnails:null!=(r=e.location)&&r.thumbnail?[{id:e.location.thumbnail.id||0,source:e.location.thumbnail.photoSizes}]:[],onRatingClick:i=>E(i,e.locationId)}})))||[],E=(e,i)=>{var t=m.find((e=>e.id===i));v({locationId:i,rating:e}).then((()=>{window.location.href=(null==t?void 0:t.writeUserReviewUrl)||""}))};return 0===m.length?null:g("div",{className:i?void 0:"FYdsq B1 Z BB Pk PY Px PK",children:g(ke,{title:t,itemsToShowMultiplier:a,initialItemsToShow:o,items:m,options:{variant:"imageLeft",onCardClick:l},desktopLayoutColumns:e})})},Si="USER_REVIEW_TRACKING",yi=(e,i)=>{var t,l=s(new Set([])),n=s(new Set([])),{page:r,params:d}=Q(),[c]=a(((t=ee.get(Si))||(t=`UserReview-${ie()}`,ee.set(Si,t)),t)),u="geoId"in d?d.geoId:null,h="detailId"in d?d.detailId:null,v=J(),p=Z(),m=o((()=>({team:"Review",geoId:u,impressionKey:c,locationId:h,page:r,customData:JSON.stringify({fromKey:c,locationID:h,reviewID:i,draftID:e})})),[r,u,h,e,i,c]);return o((()=>({logImpression:(e,i,t={})=>{i&&l.current.has(e)||(p({...m,...Le[e],...t}),l.current=new Set(l.current).add(e))},logInteraction:(e,i,t={})=>{i&&n.current.has(e)||(v({...m,...De[e],...t,actionType:"click"}),n.current=new Set(n.current).add(e))}})),[v,p,m])},Ni=({eventName:e})=>{var i=!!oe().startsWith("hare.tripadvisor");return g(te,{config:{samplingRate:1,startDate:"2023-03-01",endDate:"2023-07-01",locations:!0,eventName:e,trackingId:i?2843497:1441007}})},fi={__key:0xf83849d49d0e,id:"f83849d49d0ee97d0e3259065c7b060e",loc:{},definitions:[]},bi=e=>{var[{data:i}]=_({query:fi,variables:{locationId:e},pause:!e});return o((()=>{var e,t;return null==i||null==(e=i.locations)||null==(t=e.map((e=>{var i,t,o,a,l,n,r,d,s,c,u,h,v;return{id:null==e?void 0:e.locationId,poiName:null==e?void 0:e.localizedName,poiLocation:null==e||null==(i=e.parent)||null==(t=i.additionalNames)?void 0:t.long,street:null==e||null==(o=e.localizedStreetAddress)?void 0:o.street,image:null==e||null==(a=e.thumbnail)?void 0:a.photoSizes,writeUserReviewUrl:null==e?void 0:e.writeUserReviewUrl,rating:null==e||null==(l=e.reviewSummary)?void 0:l.rating,reviewCount:null==e||null==(n=e.reviewSummary)?void 0:n.count,award:null!=e&&null!=(r=e.locationV2)&&null!=(d=r.bestAwardForActiveYearV2)&&d.awardType?{type:null==e||null==(s=e.locationV2)||null==(c=s.bestAwardForActiveYearV2)?void 0:c.awardType,year:null==e||null==(u=e.locationV2)||null==(h=u.bestAwardForActiveYearV2)?void 0:h.year}:null,relatedLocations:(null==e||null==(v=e.relatedLocations)?void 0:v.map((e=>{var i,t,o;return{id:null==e?void 0:e.locationId,poiName:null==e?void 0:e.localizedName,poiLocation:null==e||null==(i=e.parent)||null==(t=i.additionalNames)?void 0:t.long,image:null==e||null==(o=e.thumbnail)?void 0:o.photoSizes,writeUserReviewUrl:null==e?void 0:e.writeUserReviewUrl}})))||[]}})))?void 0:t[0]}),[i])},Pi="SopVu",ki=({children:e,...i})=>g(xe.Provider,{value:i,children:e}),Ai=({locationId:e,setLocationId:i,skipProviderNavigation:t})=>{var n,{localize:r}=w(),{page:s}=Q(),{logImpression:u,logInteraction:h}=Ve(),[v,p]=a({dropdownValue:"",inputValue:""}),[_,E]=a(!1),[C,T]=a(!1),I="MOBILE"===m(),S=l((e=>{null!==e&&T(!0)}),[]);c((()=>{switch(s){case"UserReview":u("USER_REVIEW_TOUR_SELECTION_MODAL_LANDER",!0);break;case"UserReviewEdit":u("USER_REVIEW_TOUR_SELECTION_CHANGE_ACTIVITY",!0);break;default:u("USER_REVIEW_TOUR_SELECTION_PROVIDER_PAGE",!0)}}),[s,u]);var{useAttractionLocationData:f}=d(xe),b=f(e),A=o((()=>(null==b?void 0:b.relatedLocations.map((e=>{var i;return{displayName:(null==e?void 0:e.poiName)||"",value:(null==e||null==(i=e.id)?void 0:i.toString())||"",customContent:R("div",{className:"GaLho f",children:[g("div",{className:Pi,children:g(y,{source:null==e?void 0:e.image,height:"100%",width:"100%",aspectRatio:"1:1"})}),R("div",{children:[g(P,{variant:"supporting-03",children:null==e?void 0:e.poiName}),g(P,{variant:"supporting-02",children:null==e?void 0:e.poiLocation})]})]})}})))||[]),[b]),O=o((()=>null==b?void 0:b.relatedLocations.find((e=>(null==e?void 0:e.id)===Number(v.dropdownValue)))),[v,b]);c((()=>{O&&h("USER_REVIEW_TOUR_SELECTION_MODAL_SEARCH_SELECTED")}),[O,h]);var U=_?null==b?void 0:b.writeUserReviewUrl:null==O?void 0:O.writeUserReviewUrl,D=()=>{h("USER_REVIEW_TOUR_SELECTION_MODAL_CLOSE"),i(null)};return b&&null!==e?R(k,{onClose:D,title:r.string("activity_selection_modal_title"),children:[!C&&g("input",{ref:S}),R("div",{className:"bhIWD",children:[R("div",{className:"XiCpG f Mn MK Px",children:[R("div",{className:Pi,children:[g(y,{source:b.image,height:"100%",width:"100%",aspectRatio:"1:1"}),b.award&&g("div",{className:"AydSl",children:g(le,{size:"small",color:b.award?"green":"yellow",year:(null==b||null==(n=b.award)?void 0:n.year)||void 0})})]}),R("div",{children:[g(P,{variant:"title-04",marginBottom:"spacing-01",children:b.poiName}),b.rating&&b.reviewCount&&R("div",{className:"FGKgp f u",children:[(null==b?void 0:b.rating)>0&&g(K,{size:"small",rating:b.rating}),g(P,{variant:"supporting-02",children:b.reviewCount})]}),R(P,{variant:"supporting-01",marginTop:"spacing-01",children:[b.street,b.street&&", ",b.poiLocation]})]})]}),g(P,{marginBottom:"spacing-04",variant:"title-04",children:r.string("activity_selection_modal_subtitle")}),g(z,{disabled:_,marginBottom:"spacing-04",iconVariant:"singleChevron",value:v,menuLabel:r.string("tour_selector_placeholder"),placeholder:I?void 0:r.string("tour_selector_placeholder_desktop"),dropdownOptions:A,onChange:e=>{h("USER_REVIEW_TOUR_SELECTION_MODAL_SEARCH_START",!0),p(e)},fullWidthMenu:!0}),g(ae,{value:"close-button",checked:_,onToggle:(e,i)=>(e=>{e&&(h("USER_REVIEW_TOUR_SELECTION_MODAL_DONT_REMEMBER"),p({dropdownValue:"",inputValue:""})),E(e)})(i),label:g(P,{variant:"body-01",children:r.string("tour_selector_other_checkbox_label")})}),g(N,{marginTop:"spacing-04",disabled:!O&&!_,onClick:()=>{var e;h(_?"USER_REVIEW_TOUR_SELECTION_MODAL_CTA_DONT_REMEMBER":"USER_REVIEW_TOUR_SELECTION_MODAL_CTA_SEARCH_SELECTED"),t&&_||(e=U)&&(window.location.href=e),D()},children:r.string("button_continue")})]})]}):null},Oi=()=>{var e="MOBILE"===m(),{os:i}=ne(),t="IOS"===i.family;return g("meta",e&&t?{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"}:{})},Ui=()=>{var e="write_a_review_form_web_experiences_1666008828",i=re({experimentKeys:[e]});return null!=i&&"test"===i[e]},Di={__key:0x5cbcea9009e6,id:"5cbcea9009e607ae660ab10e348af62f",loc:{},definitions:[]},Mi=()=>{var e=X(),i=$(),[{data:t,fetching:a},l]=_({query:Di,variables:{userId:e||"",taUnique:i},requestPolicy:"cache-and-network"});return{draftsData:o((()=>{var e,i,o;return(null==t||null==(e=t.ReviewsProxy_getReviewDraftsForUser)||null==(i=e.flat())||null==(o=i.filter(Boolean))?void 0:o.map((e=>{var i,t,o,a,l,n,r,d,s,c,u,h,v,p;return{locationId:null==e?void 0:e.locationId,locationTitle:null==e||null==(i=e.location)?void 0:i.localizedName,locationSubtitle:null==e||null==(t=e.location)||null==(o=t.parent)||null==(a=o.additionalNames)?void 0:a.long,date:null!=e&&e.lastUpdatedDate?new Date(null==e?void 0:e.lastUpdatedDate):null,rating:(null==e?void 0:e.rating)||0,writeUserReviewUrl:(null==e||null==(l=e.location)?void 0:l.writeUserReviewUrl)||"",url:(null==e||null==(n=e.location)?void 0:n.url)||"",placeType:(null==e||null==(r=e.location)?void 0:r.placeType)||null,accommodationCategory:(null==e||null==(d=e.location)?void 0:d.accommodationCategory)||null,thumbnails:null!=e&&null!=(s=e.location)&&s.thumbnail?[{id:e.location.thumbnail.id||0,source:e.location.thumbnail.photoSizes}]:[],location:{localizedName:(null==e||null==(c=e.location)?void 0:c.localizedName)||"",thumbnail:{photoSizeDynamic:null==e||null==(u=e.location)||null==(h=u.thumbnail)?void 0:h.photoSizeDynamic}},content:(null==e?void 0:e.content)||"",title:(null==e?void 0:e.title)||"",tripType:null==e?void 0:e.tripType,travelDate:(null==e?void 0:e.travelDate)||"",photos:(null==e||null==(v=e.photoIds)?void 0:v.map(((i,t)=>{var o,a;return{id:i||-1,caption:(null==e||null==(o=e.photoCaptions)?void 0:o[t])||"",categoryId:(null==e||null==(a=e.photoCategories)?void 0:a[t])||null}})))||[],questionsAndAnswers:(null==e||null==(p=e.questionsAndAnswers)?void 0:p.map((e=>({question:(null==e?void 0:e.question)||"",answer:(null==e?void 0:e.answer)||""}))))||[]}})))||[]}),[t]),fetching:a,refetch:l}},Li=e=>{var i,t,o,a=X(),[{data:l},n]=_({query:Ri,variables:{userId:a||""},requestPolicy:"cache-and-network"}),r=(e,i)=>{var t,o,a,l;return null==e||null==(t=e.flat())||null==(o=t.filter(Boolean))||null==(a=o.filter((e=>null==e?void 0:e.locationId)))||null==(l=a.slice(0,i))?void 0:l.map((e=>{var i,t,o;return{heading:null==e||null==(i=e.location)?void 0:i.localizedName,key:String(null==e?void 0:e.locationId),locationId:null==e?void 0:e.locationId,image:null==e||null==(t=e.location)||null==(o=t.thumbnail)?void 0:o.photoSizeDynamic}}))},d={id:"your_drafts",header:g(T,{id:"ur_search_your_drafts_all_caps"}),items:r(e,5)};return{placeholderItems:[{id:"recently_viewed",header:g(T,{id:"dual_search_recently_viewed_all_caps"}),items:r(null==l||null==(i=l.ReviewsProxy_getSuggestedLocationsToReviewForUser)||null==(t=i[0])?void 0:t.suggestedLocations,5-((null==d||null==(o=d.items)?void 0:o.length)||0))},d],refetch:n}};return[()=>{de=He,se=t.createContext({photos:[],setPhotos:()=>{},croppingPhotos:[],setCroppingPhotos:()=>{},uploadModalOpenState:!1,uploadModalMobilePhotoIds:[],setUploadModalOpenState:()=>{},checkForCaptionProfanity:()=>{},tracking:void 0,isHotel:!1}),ce=Ye,ue=["top",void 0,"bottom"].flatMap((e=>["left",void 0,"right"].map((i=>({verticalPosition:e,horizontalPosition:i}))))),he=r((function({index:e,horizontalPosition:i,verticalPosition:t,handleDragEnd:o,setMovingPointIndex:a,handlePointMovement:l},n){return g("div",{draggable:!1,className:O("OSJzt _S",{PMSaD:"top"===t,wEUGc:"bottom"===t,UQQUi:"left"===i,OjCBR:"right"===i}),role:"button",ref:n,tabIndex:0,onTouchStart:()=>{a(e)},onTouchEnd:o,onMouseDown:i=>{i.preventDefault(),a(e)},onKeyDown:o=>{["ArrowDown","ArrowLeft","ArrowUp","ArrowRight"].includes(o.key)&&o.preventDefault();var a=!i&&t?0:1,n=!t&&i?0:1;switch(o.key){case"ArrowDown":l(0,a,e);break;case"ArrowUp":l(0,-a,e);break;case"ArrowLeft":l(-n,0,e);break;case"ArrowRight":l(n,0,e)}},onKeyUp:o,children:g("div",{className:"aIfPz"})})})),ve=Ke,pe=$e,me=Xe,_e=Ze,Ee={top:0,left:0,...ei},ge=ii,Re=ti,Ce=ai,Te=li,we=ri,Ie=di,Se=si,ye=ci,Ne=ui,fe=hi,be=pi,Pe=Ei,ke=gi,Ae=wi,Oe=Ii,Ue={GLOBAL_NAVIGATION:{itemType:"WriteReview",itemName:"GlobalNav",customData:JSON.stringify({})},POI_WRITE_REVIEW_HEADER:{itemType:"WriteReview",itemName:"PoiHeader"},POI_WRITE_REVIEW_SECTION:{itemType:"WriteReview",itemName:"PoiReivewSection"},USER_REVIEW_LANDER_DRAFT:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"draft"},USER_REVIEW_LANDER_DRAFT_SHOW_MORE:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"showMore"},USER_REVIEW_LANDER_SUGGESTION:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"beenThere"},USER_REVIEW_LANDER_RECENT_REVIEWS_MENU:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"recentReview"},USER_REVIEW_LANDER_LEARN_MORE:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"learnMore"},USER_REVIEW_LANDER_ADD_LISTING:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"addListing"},USER_REVIEW_LANDER_RECENT_REVIEWS_SEE_ALL:{actionSubType:"userReviewLanderClick",itemType:"userReviewLanderClick",itemName:"seeAll"},USER_REVIEW_EDIT_BUBBLE_RATING:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"bubbleRating"},USER_REVIEW_EDIT_TRAVEL_DATE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"visitDate"},USER_REVIEW_EDIT_REVIEW_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"reviewType"},USER_REVIEW_EDIT_MEAL_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"mealType"},USER_REVIEW_EDIT_SHIP_CABIN_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"shipCabinType"},USER_REVIEW_EDIT_SHIP_DESTINATION:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"shipDestination"},USER_REVIEW_EDIT_SHIP_TRIP_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"shipTripType"},USER_REVIEW_EDIT_VR_RECOMMENDATION:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"vrRecommendation"},USER_REVIEW_EDIT_AIRLINE_RECOMMENDATION_RATING:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineRecommendationRating"},USER_REVIEW_EDIT_AIRLINE_TRIP_TYPE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineTripType"},USER_REVIEW_EDIT_AIRLINE_CLASS_OF_SERVICE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineClassOfService"},USER_REVIEW_EDIT_AIRLINE_FLYING_FROM:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineFlyingFrom"},USER_REVIEW_EDIT_AIRLINE_FLYING_TO:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineFlyingTo"},USER_REVIEW_EDIT_AIRLINE_FLIGHT_NUMBER:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"airlineFlightNumber"},USER_REVIEW_EDIT_TEXT_START:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"textBodyStart",itemId:"textBodyStart"},USER_REVIEW_EDIT_TEXT_COMPLETE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"textBodyComplete",itemId:"textBodyComplete"},USER_REVIEW_EDIT_TITLE_START:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"TitleStart",itemId:"TitleStart"},USER_REVIEW_EDIT_PHOTO_UPLOAD_START:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"photoStart",itemId:"photoStart"},USER_REVIEW_EDIT_PHOTO_UPLOAD_CLOSE:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"closeCTA"},USER_REVIEW_EDIT_PHOTO_UPLOAD_ADD_MORE:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"addMorePhotosCTA"},USER_REVIEW_EDIT_PHOTO_UPLOAD_DELETE:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"deletePhotoCTA"},USER_REVIEW_EDIT_PHOTO_UPLOAD_ADD_CAPTION:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"addCaption"},USER_REVIEW_EDIT_PHOTO_UPLOAD_EDIT:{actionType:"click",actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"photoEdit"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CLOSE:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"closeCTA"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_SIZE:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_MANUAL:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Manual"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_RESET:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Reset"},USER_REVIEW_EDIT_CROP_PHOTO_MODAL_CROP_SAVE:{actionSubType:"userReviewCropPhotoModalClick",itemType:"userReviewCropPhotoModalClick",itemName:"cropSize",itemId:"Save"},USER_REVIEW_EDIT_PHOTO_UPLOAD_ATTACH:{actionSubType:"userReviewPhotoModalClick",itemType:"userReviewPhotoModalClick",itemName:"photoUpload"},USER_REVIEW_EDIT_TRUST_MODAL_ACCEPT:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"termsAgree",itemId:"termsAgree"},USER_REVIEW_EDIT_TRUST_MODAL_DECLINE:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"termsDecline",itemId:"termsDecline"},USER_REVIEW_EDIT_DRAFT_SUBMIT:{actionSubType:"userReviewEditClick",itemType:"userReviewEditClick",itemName:"submitClick",itemId:"submitClick"},USER_REVIEW_EDIT_ADDITIONAL_RATING:{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClickRate",itemName:"rateClick"},USER_REVIEW_EDIT_TIPS:{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClick",itemName:"tipsClick",itemId:"tipsClick"},USER_REVIEW_EDIT_TAGS:{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClickTag"},USER_REVIEW_EDIT_REVIEW_SUBMIT:{actionSubType:"userReviewSubmitClick",itemType:"userReviewSubmitClick",itemName:"submitClick",itemId:"submitClick"},USER_REVIEW_EDIT_CHANGE_ACTIVITY:{itemType:"userReviewEdit",itemName:"ChangeActivity"},USER_REVIEW_CELEBRATION_HOW_LONG:{itemType:"userReviewCelebration",itemName:"HowLong"},USER_REVIEW_CELEBRATION_PHONE_NUMBER:{itemType:"userReviewCelebration",itemName:"PhoneNumber"},USER_REVIEW_CELEBRATION_WEBSITE:{itemType:"userReviewCelebration",itemName:"Website"},USER_REVIEW_TOUR_SELECTION_MODAL_SEARCH_START:{itemType:"UserReviewTourSelectionModal",itemName:"SearchStart"},USER_REVIEW_TOUR_SELECTION_MODAL_SEARCH_SELECTED:{itemType:"UserReviewTourSelectionModal",itemName:"SearchSelected"},USER_REVIEW_TOUR_SELECTION_MODAL_DONT_REMEMBER:{itemType:"UserReviewTourSelectionModal",itemName:"IDontRemember"},USER_REVIEW_TOUR_SELECTION_MODAL_CTA_SEARCH_SELECTED:{itemType:"UserReviewTourSelectionModal",itemName:"CTA",actionSubType:"SearchSelected"},USER_REVIEW_TOUR_SELECTION_MODAL_CTA_DONT_REMEMBER:{itemType:"UserReviewTourSelectionModal",itemName:"CTA",actionSubType:"IDontRemember"},USER_REVIEW_TOUR_SELECTION_MODAL_CLOSE:{itemType:"UserReviewTourSelectionModal",itemName:"Close"},USER_REVIEW_TOUR_SELECTION_CTA_SEARCH_SELECTED:{itemType:"UserReviewTourSelection",itemName:"CTA",actionSubType:"SearchSelected"},USER_REVIEW_TOUR_SELECTION_CTA_DONT_REMEMBER:{itemType:"UserReviewTourSelection",itemName:"CTA",actionSubType:"IDontRemember"}},De=Ue,Me={GLOBAL_NAVIGATION:{itemType:"WriteReview",itemName:"GlobalNav",customData:JSON.stringify({})},POI_WRITE_REVIEW_HEADER:{itemType:"WriteReview",itemName:"PoiHeader"},POI_WRITE_REVIEW_SECTION:{itemType:"WriteReview",itemName:"PoiReivewSection"},USER_REVIEW_LANDER:{itemType:"userReviewLander",itemId:"userReviewLanderPage",itemName:"userReviewLanderPage"},USER_REVIEW_EDIT:{itemType:"userReviewEdit",itemId:"userReviewEditPage",itemName:"userReviewEditPage"},USER_REVIEW_EDIT_TRUST_MODAL:{itemType:"userReviewEdit",itemId:"userReviewEditTrustSafetyModal",itemName:"userReviewEditTrustSafetyModal"},USER_REVIEW_PHOTO_UPLOAD_MODAL:{itemType:"userReviewEdit",itemId:"userReviewPhotoModal",itemName:"userReviewPhotoModal"},USER_REVIEW_CROP_PHOTO_MODAL:{itemType:"userReviewEdit",itemId:"userReviewCropPhotoModal",itemName:"userReviewCropPhotoModal"},USER_REVIEW_SUBMIT:{itemType:"userReviewSubmit",itemId:"userReviewSubmitPage",itemName:"userReviewSubmitPage"},USER_REVIEW_CELEBRATION:{itemType:"userReviewCelebration",itemId:"userReviewCelebrationPage",itemName:"userReviewCelebrationPage"},USER_REVIEW_TOUR_SELECTION_MODAL_LANDER:{itemType:"UserReviewTourSelectionModal",itemName:"Lander"},USER_REVIEW_TOUR_SELECTION_PROVIDER_PAGE:{itemType:"UserReviewTourSelectionModal",itemName:"ProviderPage"},USER_REVIEW_TOUR_SELECTION_CHANGE_ACTIVITY:{itemType:"UserReviewTourSelectionModal",itemName:"UserReviewEditChangeActivity"}},Le=Me,Ve=yi,We=Ni,ze=bi,e({ActivitySelectionContext:xe=t.createContext({useAttractionLocationData:ze}),ActivitySelectionModal:Ai,ActivitySelectionProvider:ki,PhotoUpload:be,ReviewCard:Pe,ReviewCards:ke,ReviewSuggestions:Oe,Viewport:Oi,WarHotjar:We,extractDraftFormValues:Ti,useAttractionLocationData:ze,useDraftReviewsData:Mi,useFetchPhotoElements:de,usePlaceholderQueryItems:Li,useSaveDraft:Ae,useUserReviewTracking:Ve,useWarExperiencesToggle:Ui})},[e=>(t=e,o=e.useMemo,a=e.useState,l=e.useCallback,n=e.createRef,r=e.forwardRef,d=e.useContext,s=e.useRef,c=e.useEffect),e=>u=e.ErrorBoundary,e=>(h=e.useCustomPhotoUpload,v=e.CustomPhotoUploadProvider),e=>p=e.ToastProvider,e=>m=e.useViewportCategory,e=>(_=e.useQuery,E=e.useMutation),e=>(g=e.jsx,R=e.jsxs,C=e.Fragment),e=>(T=e.default,w=e.useLocalize,I=e.UnsafeLocalize,S=e.useLocale),e=>y=e.default,e=>(N=e.default,f=e.BorderlessButton,b=e.CircularButton),e=>P=e.default,e=>k=e.Modal,e=>A=e.ChipButton,e=>O=e.default,e=>U=e.default,e=>D=e.default,e=>M=e.default,e=>L=e.DropdownMenu,e=>V=e.default,e=>(W=e.TextArea,z=e.SearchableTextInput),e=>x=e.default,e=>B=e.default,e=>H=e.default,e=>F=e.Spinner,e=>G=e.default,e=>Y=e.default,e=>(q=e.BubbleRatingInput,K=e.BubbleRating),e=>j=e.default,e=>$=e.useDeviceId,e=>X=e.useUserId,e=>Q=e.useRoute,e=>J=e.default,e=>Z=e.default,e=>ee=e.default,e=>ie=e.uuid,e=>te=e.default,e=>oe=e.useDomainName,e=>ae=e.Checkbox,e=>le=e.default,e=>ne=e.useUserAgent,e=>re=e.default]]},["1o4yt4","183pm0","1iahto","tr3542","1ys6v1","1mqwhq","121h32","17thqz","34bu7w","jppfwt","1essqv","1i3sz5","1b1clj","fkji80","b5nukb","14ilds","1i0z8n","1ntn26","1qkjm8","1u3aio","1ypf49","wenm84","155gpl","1qndsd","1u47wj","1mvpl5","1bkeq2","lr6tb6","p5p2yo","52far5","fgwvq1","1r73jw","xg719z","19b9b1","1eww82","vfymw1","qlcuu5","frf6ac","p9ucm8","1nnprh","gugp1d"]]);
