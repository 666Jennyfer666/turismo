(this.$WP=this.$WP||[]).push(["3dy54m",(t,e)=>{"use strict";var i,s,r,o;return[()=>{s=class{constructor(){this.backing=void 0,this.backing=[]}add(t){this.backing.push(t)}remove(t){this.backing=this.backing.filter((e=>t.every((t=>!i(e,t)))))}readAll(){return this.backing}},t("LocalStorageBuffer",r=class{constructor(t){this.keyName=void 0,this.backup=void 0,this.keyName=t,this.backup=new s}add(t){try{var e=JSON.parse(localStorage.getItem(this.keyName)||"[]");e.push(t),localStorage.setItem(this.keyName,JSON.stringify(e))}catch(e){this.backup.add(t)}}remove(t){try{var e=this.readAll();localStorage.setItem(this.keyName,JSON.stringify(e.filter((e=>t.every((t=>!i(e,t)))))))}catch(e){this.backup.remove(t)}}readAll(){try{return JSON.parse(localStorage.getItem(this.keyName)||"[]")}catch(t){return this.backup.readAll()}}}),t("AtLeastOnceLogger",o=class{constructor(t,e=1e3){this.locked=void 0,this.buffer=void 0,this.timeout=void 0,this.logger=void 0,this.cbId=void 0,this.open=void 0,this.performLoggingAttempt=()=>{if(null!==this.logger)if(this.locked)this.enqueueLoggingAttempt();else{var t=this.buffer.readAll();if(t.length>0){this.locked=!0;try{this.logger(t).then((()=>{this.buffer.remove(t)})).finally((()=>{this.locked=!1}))}catch(t){console.error(t),this.locked=!1}}}},this.buffer=t,this.logger=null,this.locked=!1,this.timeout=e,this.cbId=null,this.open=!0}installLogger(t){this.logger=t}attemptToLog(t){this.open&&(this.buffer.add(t),this.enqueueLoggingAttempt())}enqueueLoggingAttempt(){null!==this.cbId&&(clearTimeout(this.cbId),this.cbId=null),this.cbId=setTimeout((()=>{this.performLoggingAttempt(),this.cbId=null}),this.timeout)}}),t({AtLeastOnceLogger:o,LocalStorageBuffer:r})},[t=>i=t.default]]},["b5nukb"]]);
