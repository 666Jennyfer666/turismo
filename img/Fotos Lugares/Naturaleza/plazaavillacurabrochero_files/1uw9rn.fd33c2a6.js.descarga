(this.$WP=this.$WP||[]).push(["1uw9rn",(e,r)=>{"use strict";var t,l,i,n,u,a,d,o,s,p,T,v,c,I,m=e=>{var[,r]=o(n),[,t]=o(u),[i,a]=l({fetching:!1}),d=p("SAVE_TO_TRIP"),T=Number(null==e?void 0:e.id),v="gaiTrip"===(null==e?void 0:e.type),c=v?"COPY_TRIP":"ADD_ITEM_TO_TRIP";return e?[i,async l=>{a({fetching:!0});try{var i,n;if(v){if(!isNaN(T)){var u,o,p,I,m,h,y=await t({copyComments:!1,tripId:T,targetTripId:l});i={id:null!=(u=null==y||null==(o=y.data)||null==(p=o.Trips_copyTrip)?void 0:p.tripId)?u:0,__typename:"Trip"},n=null==y||null==(I=y.data)||null==(m=I.Trips_copyTrip)||null==(h=m.errors)?void 0:h[0]}}else{var f,g,_,E,P,R,q=await r({tripId:l,referenceId:`${e.id}`,referenceType:e.type,allowDuplicates:!1});i=null==q||null==(f=q.data)||null==(g=f.addItemToTrip)?void 0:g.trip,n=null==q||null==(_=q.data)||null==(E=_.addItemToTrip)||null==(P=E.errors)||null==(R=P[0])?void 0:R.error}return((r,t)=>{if(r){var l=s(r,e);l?(d(),a({fetching:!1,result:{trip:r,tripItem:l}})):["bundleSave","gaiTrip"].includes(e.type)?a({fetching:!1,result:{trip:r,tripItem:{__typename:"TripItem",id:0,comments:[]}}}):a({fetching:!1,error:{query:c,tripsError:null!=t?t:void 0}})}else a({fetching:!1,error:{query:c,tripsError:null!=t?t:void 0}})})(i,n),[i,n]}catch(e){return console.error(e),a({fetching:!1,error:{query:c}}),[null,null]}}]:[i,()=>Promise.resolve([null,null])]},h="mostRecentlyAddedToTrip",y=e=>{var r=T.get(h);return r&&r.userId===e?r.tripId:null},f=(e,r,t,l)=>{var[n,u]=c(r),a=v();return[n,i((()=>{var i=null!=e?e:y(a);return t||!i||null!=(null==r?void 0:r.type)&&I.has(r.type)?(l&&l(),Promise.resolve([null,null])):u(i)}),[t,r,l,u,a,e]),e=>((e,r)=>{r?T.set(h,{tripId:e,userId:r},144e5):T.remove(h)})(e,a)]},g=(e,r,l)=>{var[i,n]=t.useState({fetching:!1,saved:!!l}),[,u]=o(a),[,s]=o(d);return[i,l?()=>l?(n({...i,fetching:!0}),s({itemId:l.id,tripId:r}).then((e=>{var r,t=null==e||null==(r=e.data)?void 0:r.tripsRemoveItem;return t?(n({fetching:!1,saved:!1,result:{trip:t}}),i):(n({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM",tripsError:void 0}}),i)})).catch((()=>(n({fetching:!1,saved:!0,error:{query:"REMOVE_TRIP_ITEM"}}),i)))):Promise.resolve(i):()=>(n({...i,fetching:!0}),u({tripId:r,referenceId:`${e.id}`,referenceType:e.type,allowDuplicates:!1}).then((e=>{var r,t,l,u,a,d,o,s,p,T=null==e||null==(r=e.data)||null==(t=r.addItemToTrip)?void 0:t.trip,v=null==e||null==(l=e.data)||null==(u=l.addItemToTrip)||null==(a=u.errors)||null==(d=a[0])?void 0:d.error;if(v||!T)return n({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP",tripsError:v||void 0}}),i;var c=null==e||null==(o=e.data)||null==(s=o.addItemToTrip)||null==(p=s.items)?void 0:p[0];return n(c?{fetching:!1,saved:!0,result:{trip:T,tripItem:c}}:{fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),i})).catch((()=>(n({fetching:!1,saved:!1,error:{query:"ADD_ITEM_TO_TRIP"}}),i))))]};return[()=>{c=m,I=new Set(["savesItem","bundleSave"]),e({getMostRecentlyAddedToTrip:y,useAutosave:f,useSave:c,useTripSaveToggle:g})},[e=>(t=e,l=e.useState,i=e.useCallback),e=>(n=e.AddItemToTrip,u=e.TripsCopyTrip,a=e.AddItemWithFullTrip,d=e.RemoveItemWithFullTrip),e=>o=e.useMutation,e=>s=e.getItemByReference,e=>p=e.usePixelCallback,e=>T=e.default,e=>v=e.useUserId]]},["1o4yt4","ag9b0s","1mqwhq","1iyqcw","1emwhd","19b9b1","52far5"]]);
