(this.$WP=this.$WP||[]).push(["14lbe8",(e,t)=>{"use strict";var r,n,o,l,a,s=["//","while(true);","while(1);","for(;;);"];function i(e,t,r){var n=r?`&${new URLSearchParams(r).toString()}`:"";return n=n.concat("&flowOrigin=optimus"),fetch(`/HotelBookingController?flowState=${e}${n}`,{method:"POST",body:JSON.stringify(t),credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((t=>{if(t.ok)return t.text();throw new Error(`Unable to fetch booking data for flow state: ${e}`)})).then((e=>(e=>{if("string"!=typeof e)throw new Error("Unable to parse JSON response");for(var t=0;t<s.length;t++){var r=s[t];if(0===e.indexOf(r))return JSON.parse(e.substring(r.length))}return JSON.parse(e)})(e))).catch((t=>{throw new Error(t||`Error while fetching data for flow state: ${e}`)}))}function u(e){var t=function(e){var t={...e,transactionId:r()};return["partnerInfos","paymentCountryConfig","phoneCountryConfig","billingInformation","metaOffers","hotelPhotos"].forEach((e=>delete t[e])),t}(e);i("BOOK",t).then((e=>console.debug("Booking submitted, res:",e)))}function d(){var e=a(),[t,l]=n([]),[s,u]=n(null),[d,c]=n(!0);return o((()=>{i("GET_CARDS",void 0,{requestId:r()}).then((e=>{l((e||[]).filter((e=>(e=>{var t,r,n=null==e||null==(t=e.storedCardInfo)||null==(r=t.billingAddressInfo)?void 0:r.addressInfo;return(null==n?void 0:n.country)&&(null==n?void 0:n.street)&&(null==n?void 0:n.city)&&(null==n?void 0:n.state)&&(null==n?void 0:n.postalCode)})(e)))),u(null)})).catch((e=>{u(e),l([])})).finally((()=>{c(!1)}))}),[e]),[t,s,d]}function c(e,t,l,s){var u=a(),[d,c]=n(null),[f,h]=n(null),[m,v]=n(!0);return o((()=>{i("START",{bookingSessionId:e,selectedRoomKey:t.key,selectedPartnerName:l.name,locationId:l.hotel.locationId,transactionId:r(),trackingContext:s}).then((e=>{c(e),h(null)})).catch((e=>{h(e),c(null)})).finally((()=>{v(!1)}))}),[e,t,l,s,u]),[d,f,m]}function f(){var e=a(),[t,r]=n(null),[l,s]=n(null),[u,d]=n(!0);return o((()=>{i("SENSITIVE").then((e=>{var t={email:e.email||"",firstName:e.firstName||"",lastName:e.lastName||"",phoneNumbers:e.phoneNumbers,streetAddresses:e.streetAddresses};r(t),s(null)})).catch((e=>{s(e),r(null)})).finally((()=>{d(!1)}))}),[e]),[t,l,u]}var h=(e,t)=>{var{originalMetaPrice:r}=t;return l((()=>{var t,n,o=(null==e||null==(t=e[0])?void 0:t.rooms.some((e=>!!e.cashbackReward)))||!1,l=null==e||null==(n=e[0])?void 0:n.rooms.map((e=>{return t=e.displayPrice,parseInt(t.replace(/[^0-9]/g,""),10);var t}));return null!=l&&l.some((e=>((e,t,r)=>{if(r){var n=t-e;return n>=-10&&n<=3}return t===e})(r,e,o)))?"same":null!=l&&l.some((e=>e<r))?"lower":"higher"}),[e,r])};return e({attemptBooking:u,useSensitiveFlowState:f,useStartFlowState:c,useStoredCardsFlowState:d}),[()=>{e({attemptBooking:u,usePriceMismatchCheck:h,useSensitiveFlowState:f,useStartFlowState:c,useStoredCardsFlowState:d})},[e=>r=e.uuid,e=>(n=e.useState,o=e.useEffect,l=e.useMemo),e=>a=e.useUserId]]},["1eww82","1o4yt4","52far5"]]);
